"use strict";var cov_23bluhnxjf=function(){var path="C:\\Users\\PIH\\Documents\\challenge\\controller\\controller.js";var hash="b52c64f4d111505e32d02b45f4eb33f647950342";var Function=function(){}.constructor;var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\PIH\\Documents\\challenge\\controller\\controller.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:19},end:{line:7,column:563}},"2":{start:{line:7,column:76},end:{line:7,column:347}},"3":{start:{line:7,column:89},end:{line:7,column:90}},"4":{start:{line:7,column:134},end:{line:7,column:142}},"5":{start:{line:7,column:144},end:{line:7,column:199}},"6":{start:{line:7,column:200},end:{line:7,column:231}},"7":{start:{line:7,column:232},end:{line:7,column:286}},"8":{start:{line:7,column:259},end:{line:7,column:286}},"9":{start:{line:7,column:287},end:{line:7,column:345}},"10":{start:{line:7,column:350},end:{line:7,column:559}},"11":{start:{line:7,column:407},end:{line:7,column:475}},"12":{start:{line:7,column:423},end:{line:7,column:475}},"13":{start:{line:7,column:476},end:{line:7,column:536}},"14":{start:{line:7,column:493},end:{line:7,column:536}},"15":{start:{line:7,column:537},end:{line:7,column:556}},"16":{start:{line:9,column:12},end:{line:9,column:37}},"17":{start:{line:11,column:13},end:{line:11,column:42}},"18":{start:{line:13,column:13},end:{line:13,column:39}},"19":{start:{line:15,column:14},end:{line:15,column:44}},"20":{start:{line:17,column:18},end:{line:17,column:49}},"21":{start:{line:19,column:19},end:{line:19,column:54}},"22":{start:{line:21,column:13},end:{line:21,column:47}},"23":{start:{line:23,column:14},end:{line:23,column:44}},"24":{start:{line:25,column:14},end:{line:25,column:31}},"25":{start:{line:27,column:15},end:{line:27,column:46}},"26":{start:{line:29,column:39},end:{line:29,column:93}},"27":{start:{line:31,column:50},end:{line:31,column:151}},"28":{start:{line:31,column:92},end:{line:31,column:149}},"29":{start:{line:33,column:22},end:{line:258,column:3}},"30":{start:{line:35,column:4},end:{line:35,column:43}},"31":{start:{line:38,column:2},end:{line:255,column:6}},"32":{start:{line:44,column:6},end:{line:48,column:9}},"33":{start:{line:53,column:26},end:{line:53,column:36}},"34":{start:{line:54,column:26},end:{line:54,column:31}},"35":{start:{line:55,column:27},end:{line:57,column:8}},"36":{start:{line:56,column:8},end:{line:56,column:84}},"37":{start:{line:58,column:6},end:{line:70,column:7}},"38":{start:{line:59,column:8},end:{line:63,column:11}},"39":{start:{line:65,column:8},end:{line:69,column:11}},"40":{start:{line:75,column:26},end:{line:75,column:36}},"41":{start:{line:76,column:26},end:{line:76,column:30}},"42":{start:{line:77,column:24},end:{line:79,column:8}},"43":{start:{line:78,column:8},end:{line:78,column:84}},"44":{start:{line:80,column:6},end:{line:92,column:7}},"45":{start:{line:81,column:8},end:{line:85,column:11}},"46":{start:{line:87,column:8},end:{line:91,column:11}},"47":{start:{line:97,column:6},end:{line:101,column:9}},"48":{start:{line:109,column:15},end:{line:109,column:51}},"49":{start:{line:110,column:22},end:{line:110,column:30}},"50":{start:{line:111,column:22},end:{line:111,column:41}},"51":{start:{line:112,column:21},end:{line:112,column:39}},"52":{start:{line:113,column:18},end:{line:113,column:33}},"53":{start:{line:114,column:18},end:{line:114,column:33}},"54":{start:{line:115,column:19},end:{line:115,column:35}},"55":{start:{line:118,column:22},end:{line:120,column:8}},"56":{start:{line:119,column:8},end:{line:119,column:48}},"57":{start:{line:121,column:6},end:{line:148,column:7}},"58":{start:{line:122,column:8},end:{line:125,column:11}},"59":{start:{line:127,column:25},end:{line:141,column:9}},"60":{start:{line:142,column:8},end:{line:142,column:41}},"61":{start:{line:143,column:8},end:{line:147,column:11}},"62":{start:{line:153,column:15},end:{line:153,column:56}},"63":{start:{line:154,column:19},end:{line:154,column:36}},"64":{start:{line:155,column:23},end:{line:155,column:42}},"65":{start:{line:158,column:20},end:{line:160,column:8}},"66":{start:{line:159,column:8},end:{line:159,column:39}},"67":{start:{line:161,column:6},end:{line:183,column:7}},"68":{start:{line:162,column:30},end:{line:171,column:9}},"69":{start:{line:172,column:8},end:{line:172,column:51}},"70":{start:{line:173,column:8},end:{line:177,column:11}},"71":{start:{line:179,column:8},end:{line:182,column:11}},"72":{start:{line:191,column:15},end:{line:191,column:28}},"73":{start:{line:194,column:20},end:{line:196,column:8}},"74":{start:{line:195,column:8},end:{line:195,column:35}},"75":{start:{line:197,column:6},end:{line:207,column:7}},"76":{start:{line:198,column:8},end:{line:198,column:41}},"77":{start:{line:199,column:8},end:{line:202,column:11}},"78":{start:{line:204,column:8},end:{line:206,column:11}},"79":{start:{line:218,column:15},end:{line:218,column:28}},"80":{start:{line:220,column:21},end:{line:222,column:8}},"81":{start:{line:221,column:8},end:{line:221,column:33}},"82":{start:{line:223,column:6},end:{line:232,column:7}},"83":{start:{line:224,column:8},end:{line:227,column:11}},"84":{start:{line:229,column:8},end:{line:231,column:11}},"85":{start:{line:239,column:15},end:{line:239,column:28}},"86":{start:{line:241,column:23},end:{line:243,column:8}},"87":{start:{line:242,column:8},end:{line:242,column:35}},"88":{start:{line:244,column:6},end:{line:253,column:7}},"89":{start:{line:245,column:8},end:{line:248,column:11}},"90":{start:{line:250,column:8},end:{line:252,column:11}},"91":{start:{line:257,column:2},end:{line:257,column:25}},"92":{start:{line:260,column:0},end:{line:260,column:34}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:19},end:{line:7,column:20}},loc:{start:{line:7,column:31},end:{line:7,column:561}},line:7},"1":{name:"defineProperties",decl:{start:{line:7,column:42},end:{line:7,column:58}},loc:{start:{line:7,column:74},end:{line:7,column:349}},line:7},"2":{name:"(anonymous_2)",decl:{start:{line:7,column:357},end:{line:7,column:358}},loc:{start:{line:7,column:405},end:{line:7,column:558}},line:7},"3":{name:"_interopRequireDefault",decl:{start:{line:29,column:9},end:{line:29,column:31}},loc:{start:{line:29,column:37},end:{line:29,column:95}},line:29},"4":{name:"_classCallCheck",decl:{start:{line:31,column:9},end:{line:31,column:24}},loc:{start:{line:31,column:48},end:{line:31,column:153}},line:31},"5":{name:"(anonymous_5)",decl:{start:{line:33,column:22},end:{line:33,column:23}},loc:{start:{line:33,column:34},end:{line:258,column:1}},line:33},"6":{name:"postsController",decl:{start:{line:34,column:11},end:{line:34,column:26}},loc:{start:{line:34,column:29},end:{line:36,column:3}},line:34},"7":{name:"getloans",decl:{start:{line:43,column:20},end:{line:43,column:28}},loc:{start:{line:43,column:39},end:{line:49,column:5}},line:43},"8":{name:"getnotrepaid",decl:{start:{line:52,column:20},end:{line:52,column:32}},loc:{start:{line:52,column:43},end:{line:71,column:5}},line:52},"9":{name:"(anonymous_9)",decl:{start:{line:55,column:48},end:{line:55,column:49}},loc:{start:{line:55,column:68},end:{line:57,column:7}},line:55},"10":{name:"getrepaid",decl:{start:{line:74,column:20},end:{line:74,column:29}},loc:{start:{line:74,column:40},end:{line:93,column:5}},line:74},"11":{name:"(anonymous_11)",decl:{start:{line:77,column:45},end:{line:77,column:46}},loc:{start:{line:77,column:65},end:{line:79,column:7}},line:77},"12":{name:"getrepayments",decl:{start:{line:96,column:20},end:{line:96,column:33}},loc:{start:{line:96,column:44},end:{line:102,column:5}},line:96},"13":{name:"createloans",decl:{start:{line:108,column:20},end:{line:108,column:31}},loc:{start:{line:108,column:42},end:{line:149,column:5}},line:108},"14":{name:"(anonymous_14)",decl:{start:{line:118,column:43},end:{line:118,column:44}},loc:{start:{line:118,column:63},end:{line:120,column:7}},line:118},"15":{name:"createrepayments",decl:{start:{line:152,column:20},end:{line:152,column:36}},loc:{start:{line:152,column:47},end:{line:184,column:5}},line:152},"16":{name:"(anonymous_16)",decl:{start:{line:158,column:41},end:{line:158,column:42}},loc:{start:{line:158,column:63},end:{line:160,column:7}},line:158},"17":{name:"verifyloan",decl:{start:{line:190,column:20},end:{line:190,column:30}},loc:{start:{line:190,column:41},end:{line:208,column:5}},line:190},"18":{name:"(anonymous_18)",decl:{start:{line:194,column:41},end:{line:194,column:42}},loc:{start:{line:194,column:63},end:{line:196,column:7}},line:194},"19":{name:"getOneloan",decl:{start:{line:217,column:20},end:{line:217,column:30}},loc:{start:{line:217,column:41},end:{line:233,column:5}},line:217},"20":{name:"(anonymous_20)",decl:{start:{line:220,column:42},end:{line:220,column:43}},loc:{start:{line:220,column:62},end:{line:222,column:7}},line:220},"21":{name:"getOnepayment",decl:{start:{line:238,column:20},end:{line:238,column:33}},loc:{start:{line:238,column:44},end:{line:254,column:5}},line:238},"22":{name:"(anonymous_22)",decl:{start:{line:241,column:49},end:{line:241,column:50}},loc:{start:{line:241,column:71},end:{line:243,column:7}},line:241}},branchMap:{"0":{loc:{start:{line:7,column:168},end:{line:7,column:198}},type:"binary-expr",locations:[{start:{line:7,column:168},end:{line:7,column:189}},{start:{line:7,column:193},end:{line:7,column:198}}],line:7},"1":{loc:{start:{line:7,column:232},end:{line:7,column:286}},type:"if",locations:[{start:{line:7,column:232},end:{line:7,column:286}},{start:{line:7,column:232},end:{line:7,column:286}}],line:7},"2":{loc:{start:{line:7,column:407},end:{line:7,column:475}},type:"if",locations:[{start:{line:7,column:407},end:{line:7,column:475}},{start:{line:7,column:407},end:{line:7,column:475}}],line:7},"3":{loc:{start:{line:7,column:476},end:{line:7,column:536}},type:"if",locations:[{start:{line:7,column:476},end:{line:7,column:536}},{start:{line:7,column:476},end:{line:7,column:536}}],line:7},"4":{loc:{start:{line:29,column:46},end:{line:29,column:92}},type:"cond-expr",locations:[{start:{line:29,column:70},end:{line:29,column:73}},{start:{line:29,column:76},end:{line:29,column:92}}],line:29},"5":{loc:{start:{line:29,column:46},end:{line:29,column:67}},type:"binary-expr",locations:[{start:{line:29,column:46},end:{line:29,column:49}},{start:{line:29,column:53},end:{line:29,column:67}}],line:29},"6":{loc:{start:{line:31,column:50},end:{line:31,column:151}},type:"if",locations:[{start:{line:31,column:50},end:{line:31,column:151}},{start:{line:31,column:50},end:{line:31,column:151}}],line:31},"7":{loc:{start:{line:56,column:15},end:{line:56,column:83}},type:"binary-expr",locations:[{start:{line:56,column:15},end:{line:56,column:47}},{start:{line:56,column:51},end:{line:56,column:83}}],line:56},"8":{loc:{start:{line:58,column:6},end:{line:70,column:7}},type:"if",locations:[{start:{line:58,column:6},end:{line:70,column:7}},{start:{line:58,column:6},end:{line:70,column:7}}],line:58},"9":{loc:{start:{line:78,column:15},end:{line:78,column:83}},type:"binary-expr",locations:[{start:{line:78,column:15},end:{line:78,column:47}},{start:{line:78,column:51},end:{line:78,column:83}}],line:78},"10":{loc:{start:{line:80,column:6},end:{line:92,column:7}},type:"if",locations:[{start:{line:80,column:6},end:{line:92,column:7}},{start:{line:80,column:6},end:{line:92,column:7}}],line:80},"11":{loc:{start:{line:121,column:6},end:{line:148,column:7}},type:"if",locations:[{start:{line:121,column:6},end:{line:148,column:7}},{start:{line:121,column:6},end:{line:148,column:7}}],line:121},"12":{loc:{start:{line:161,column:6},end:{line:183,column:7}},type:"if",locations:[{start:{line:161,column:6},end:{line:183,column:7}},{start:{line:161,column:6},end:{line:183,column:7}}],line:161},"13":{loc:{start:{line:197,column:6},end:{line:207,column:7}},type:"if",locations:[{start:{line:197,column:6},end:{line:207,column:7}},{start:{line:197,column:6},end:{line:207,column:7}}],line:197},"14":{loc:{start:{line:223,column:6},end:{line:232,column:7}},type:"if",locations:[{start:{line:223,column:6},end:{line:232,column:7}},{start:{line:223,column:6},end:{line:232,column:7}}],line:223},"15":{loc:{start:{line:244,column:6},end:{line:253,column:7}},type:"if",locations:[{start:{line:244,column:6},end:{line:253,column:7}},{start:{line:244,column:6},end:{line:253,column:7}}],line:244}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_23bluhnxjf.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _createClass=(cov_23bluhnxjf.s[1]++,function(){cov_23bluhnxjf.f[0]++;function defineProperties(target,props){cov_23bluhnxjf.f[1]++;cov_23bluhnxjf.s[2]++;for(var i=(cov_23bluhnxjf.s[3]++,0);i<props.length;i++){var descriptor=(cov_23bluhnxjf.s[4]++,props[i]);cov_23bluhnxjf.s[5]++;descriptor.enumerable=(cov_23bluhnxjf.b[0][0]++,descriptor.enumerable)||(cov_23bluhnxjf.b[0][1]++,false);cov_23bluhnxjf.s[6]++;descriptor.configurable=true;cov_23bluhnxjf.s[7]++;if("value"in descriptor){cov_23bluhnxjf.b[1][0]++;cov_23bluhnxjf.s[8]++;descriptor.writable=true;}else{cov_23bluhnxjf.b[1][1]++;}cov_23bluhnxjf.s[9]++;Object.defineProperty(target,descriptor.key,descriptor);}}cov_23bluhnxjf.s[10]++;return function(Constructor,protoProps,staticProps){cov_23bluhnxjf.f[2]++;cov_23bluhnxjf.s[11]++;if(protoProps){cov_23bluhnxjf.b[2][0]++;cov_23bluhnxjf.s[12]++;defineProperties(Constructor.prototype,protoProps);}else{cov_23bluhnxjf.b[2][1]++;}cov_23bluhnxjf.s[13]++;if(staticProps){cov_23bluhnxjf.b[3][0]++;cov_23bluhnxjf.s[14]++;defineProperties(Constructor,staticProps);}else{cov_23bluhnxjf.b[3][1]++;}cov_23bluhnxjf.s[15]++;return Constructor;};}());var _user=(cov_23bluhnxjf.s[16]++,require("../models/user"));var _user2=(cov_23bluhnxjf.s[17]++,_interopRequireDefault(_user));var _loans=(cov_23bluhnxjf.s[18]++,require("../models/loans"));var _loans2=(cov_23bluhnxjf.s[19]++,_interopRequireDefault(_loans));var _repayments=(cov_23bluhnxjf.s[20]++,require("../models/repayments"));var _repayments2=(cov_23bluhnxjf.s[21]++,_interopRequireDefault(_repayments));var _check=(cov_23bluhnxjf.s[22]++,require("express-validator/check"));var _check2=(cov_23bluhnxjf.s[23]++,_interopRequireDefault(_check));var _moment=(cov_23bluhnxjf.s[24]++,require("moment"));var _moment2=(cov_23bluhnxjf.s[25]++,_interopRequireDefault(_moment));function _interopRequireDefault(obj){cov_23bluhnxjf.f[3]++;cov_23bluhnxjf.s[26]++;return(cov_23bluhnxjf.b[5][0]++,obj)&&(cov_23bluhnxjf.b[5][1]++,obj.__esModule)?(cov_23bluhnxjf.b[4][0]++,obj):(cov_23bluhnxjf.b[4][1]++,{default:obj});}function _classCallCheck(instance,Constructor){cov_23bluhnxjf.f[4]++;cov_23bluhnxjf.s[27]++;if(!(instance instanceof Constructor)){cov_23bluhnxjf.b[6][0]++;cov_23bluhnxjf.s[28]++;throw new TypeError("Cannot call a class as a function");}else{cov_23bluhnxjf.b[6][1]++;}}var postsController=(cov_23bluhnxjf.s[29]++,function(){cov_23bluhnxjf.f[5]++;function postsController(){cov_23bluhnxjf.f[6]++;cov_23bluhnxjf.s[30]++;_classCallCheck(this,postsController);}cov_23bluhnxjf.s[31]++;_createClass(postsController,null,[{key:"getloans",//get function
value:function getloans(req,res){cov_23bluhnxjf.f[7]++;cov_23bluhnxjf.s[32]++;return res.status(200).json({status:200,message:"List of all loans",loan:_loans2.default});}},{key:"getnotrepaid",value:function getnotrepaid(req,res){cov_23bluhnxjf.f[8]++;var currentstatus=(cov_23bluhnxjf.s[33]++,"approved");var currentrepaid=(cov_23bluhnxjf.s[34]++,false);var checknotrepaid=(cov_23bluhnxjf.s[35]++,_loans2.default.find(function(oneloans){cov_23bluhnxjf.f[9]++;cov_23bluhnxjf.s[36]++;return(cov_23bluhnxjf.b[7][0]++,oneloans.status==currentstatus)&&(cov_23bluhnxjf.b[7][1]++,oneloans.repaid==currentrepaid);}));cov_23bluhnxjf.s[37]++;if(checknotrepaid){cov_23bluhnxjf.b[8][0]++;cov_23bluhnxjf.s[38]++;return res.status(200).json({status:200,message:"List of all loans that are not fully repaid",loan:checknotrepaid});}else{cov_23bluhnxjf.b[8][1]++;cov_23bluhnxjf.s[39]++;return res.status(400).json({status:404,error:" can't find any loan that is not fully repaid"});}}},{key:"getrepaid",value:function getrepaid(req,res){cov_23bluhnxjf.f[10]++;var currentstatus=(cov_23bluhnxjf.s[40]++,"approved");var currentrepaid=(cov_23bluhnxjf.s[41]++,true);var checkrepaid=(cov_23bluhnxjf.s[42]++,_loans2.default.find(function(oneloans){cov_23bluhnxjf.f[11]++;cov_23bluhnxjf.s[43]++;return(cov_23bluhnxjf.b[9][0]++,oneloans.status==currentstatus)&&(cov_23bluhnxjf.b[9][1]++,oneloans.repaid==currentrepaid);}));cov_23bluhnxjf.s[44]++;if(checkrepaid){cov_23bluhnxjf.b[10][0]++;cov_23bluhnxjf.s[45]++;return res.status(200).json({status:200,message:"List of all loans that are  fully repaid",loan:checkrepaid});}else{cov_23bluhnxjf.b[10][1]++;cov_23bluhnxjf.s[46]++;return res.status(400).json({status:404,error:" can't find any loan that is  fully repaid"});}}},{key:"getrepayments",value:function getrepayments(req,res){cov_23bluhnxjf.f[12]++;cov_23bluhnxjf.s[47]++;return res.status(200).json({status:200,message:"List of all repayments",candidate:_repayments2.default});}//create function
},{key:"createloans",value:function createloans(req,res){cov_23bluhnxjf.f[13]++;var id=(cov_23bluhnxjf.s[48]++,parseInt(_loans2.default.length)+1);var _req$body=(cov_23bluhnxjf.s[49]++,req.body),firstname=(cov_23bluhnxjf.s[50]++,_req$body.firstname),lastname=(cov_23bluhnxjf.s[51]++,_req$body.lastname),email=(cov_23bluhnxjf.s[52]++,_req$body.email),tenor=(cov_23bluhnxjf.s[53]++,_req$body.tenor),amount=(cov_23bluhnxjf.s[54]++,_req$body.amount);var checkloan=(cov_23bluhnxjf.s[55]++,_loans2.default.find(function(oneloans){cov_23bluhnxjf.f[14]++;cov_23bluhnxjf.s[56]++;return oneloans.email==req.body.email;}));cov_23bluhnxjf.s[57]++;if(checkloan){cov_23bluhnxjf.b[11][0]++;cov_23bluhnxjf.s[58]++;return res.status(400).json({message:"loan already exist"});}else{cov_23bluhnxjf.b[11][1]++;var insertloan=(cov_23bluhnxjf.s[59]++,{id:id,createdOn:_moment2.default.utc().format(),firstname:firstname,lastname:lastname,email:email,status:"pending",repaid:false,tenor:tenor,amount:amount,paymentInstallment:(parseFloat(req.body.amount)+parseFloat(req.body.amount*5/100))/parseFloat(req.body.tenor),balance:parseFloat((parseFloat(req.body.amount)+parseFloat(req.body.amount*5/100))/parseFloat(req.body.tenor)*tenor),interest:req.body.amount*5/100});cov_23bluhnxjf.s[60]++;_loans2.default.push(insertloan);cov_23bluhnxjf.s[61]++;return res.status(200).json({status:200,message:"loan created successfully",loan:insertloan});}}},{key:"createrepayments",value:function createrepayments(req,res){cov_23bluhnxjf.f[15]++;var id=(cov_23bluhnxjf.s[62]++,parseInt(_repayments2.default.length)+1);var loanid=(cov_23bluhnxjf.s[63]++,req.params.loanid);var paidamount=(cov_23bluhnxjf.s[64]++,req.body.paidamount);var getloan=(cov_23bluhnxjf.s[65]++,_loans2.default.find(function(updateloan){cov_23bluhnxjf.f[16]++;cov_23bluhnxjf.s[66]++;return updateloan.id==loanid;}));cov_23bluhnxjf.s[67]++;if(getloan){cov_23bluhnxjf.b[12][0]++;var insertrepayment=(cov_23bluhnxjf.s[68]++,{id:id,createdOn:_moment2.default.utc().format(),loanId:getloan.id,amount:getloan.amount,monthlyInstallment:getloan.paymentInstallment,paidamount:paidamount,balance:parseFloat(getloan.balance)-parseFloat(req.body.paidamount)});cov_23bluhnxjf.s[69]++;_repayments2.default.push(insertrepayment);cov_23bluhnxjf.s[70]++;return res.status(200).json({status:200,message:"payment done successfully",loan:insertrepayment});}else{cov_23bluhnxjf.b[12][1]++;cov_23bluhnxjf.s[71]++;return res.status(400).json({message:"that loan doesn't exist"});}}//update function (patch)
},{key:"verifyloan",value:function verifyloan(req,res){cov_23bluhnxjf.f[17]++;var id=(cov_23bluhnxjf.s[72]++,req.params.id);var getloan=(cov_23bluhnxjf.s[73]++,_loans2.default.find(function(updateloan){cov_23bluhnxjf.f[18]++;cov_23bluhnxjf.s[74]++;return updateloan.id==id;}));cov_23bluhnxjf.s[75]++;if(getloan){cov_23bluhnxjf.b[13][0]++;cov_23bluhnxjf.s[76]++;getloan.status=req.body.status;cov_23bluhnxjf.s[77]++;return res.status(201).json({message:"loan is approved succesfully",updatePost:getloan});}else{cov_23bluhnxjf.b[13][1]++;cov_23bluhnxjf.s[78]++;res.status(400).json({error:"can't find that loan with that id"});}}////////////////////////////////////////////////////////////////////
//get loan by id
},{key:"getOneloan",value:function getOneloan(req,res){cov_23bluhnxjf.f[19]++;var id=(cov_23bluhnxjf.s[79]++,req.params.id);var findloan=(cov_23bluhnxjf.s[80]++,_loans2.default.find(function(oneloans){cov_23bluhnxjf.f[20]++;cov_23bluhnxjf.s[81]++;return oneloans.id==id;}));cov_23bluhnxjf.s[82]++;if(findloan){cov_23bluhnxjf.b[14][0]++;cov_23bluhnxjf.s[83]++;return res.status(200).json({message:"one loan found",loan:findloan});}else{cov_23bluhnxjf.b[14][1]++;cov_23bluhnxjf.s[84]++;res.status(400).json({error:"no loan found with that id"});}}// get payment by id
},{key:"getOnepayment",value:function getOnepayment(req,res){cov_23bluhnxjf.f[21]++;var id=(cov_23bluhnxjf.s[85]++,req.params.id);var getpayment=(cov_23bluhnxjf.s[86]++,_repayments2.default.find(function(onepayment){cov_23bluhnxjf.f[22]++;cov_23bluhnxjf.s[87]++;return onepayment.id==id;}));cov_23bluhnxjf.s[88]++;if(getpayment){cov_23bluhnxjf.b[15][0]++;cov_23bluhnxjf.s[89]++;return res.status(200).json({message:"payment found",payment:getpayment});}else{cov_23bluhnxjf.b[15][1]++;cov_23bluhnxjf.s[90]++;res.status(400).json({error:"no payment found with that id"});}}}]);cov_23bluhnxjf.s[91]++;return postsController;}());cov_23bluhnxjf.s[92]++;exports.default=postsController;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsicG9zdHNDb250cm9sbGVyIiwicmVxIiwicmVzIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJsb2FuIiwibG9hbnMiLCJjdXJyZW50c3RhdHVzIiwiY3VycmVudHJlcGFpZCIsImNoZWNrbm90cmVwYWlkIiwiZmluZCIsIm9uZWxvYW5zIiwicmVwYWlkIiwiZXJyb3IiLCJjaGVja3JlcGFpZCIsImNhbmRpZGF0ZSIsInJlcGF5bWVudHMiLCJpZCIsInBhcnNlSW50IiwibGVuZ3RoIiwiYm9keSIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwiZW1haWwiLCJ0ZW5vciIsImFtb3VudCIsImNoZWNrbG9hbiIsImluc2VydGxvYW4iLCJjcmVhdGVkT24iLCJtb21lbnQiLCJ1dGMiLCJmb3JtYXQiLCJwYXltZW50SW5zdGFsbG1lbnQiLCJwYXJzZUZsb2F0IiwiYmFsYW5jZSIsImludGVyZXN0IiwicHVzaCIsImxvYW5pZCIsInBhcmFtcyIsInBhaWRhbW91bnQiLCJnZXRsb2FuIiwidXBkYXRlbG9hbiIsImluc2VydHJlcGF5bWVudCIsImxvYW5JZCIsIm1vbnRobHlJbnN0YWxsbWVudCIsInVwZGF0ZVBvc3QiLCJmaW5kbG9hbiIsImdldHBheW1lbnQiLCJvbmVwYXltZW50IiwicGF5bWVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7OztJQUVNQSxlOzs7Ozs7Ozs7QUFFTjs2QkFDa0JDLEcsRUFBS0MsRyxFQUFLO0FBQ2hCLGFBQU9BLElBQUlDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkQsZ0JBQU8sR0FEbUI7QUFFMUJFLGlCQUFTLG1CQUZpQjtBQUcxQkMsY0FBTUM7QUFIb0IsT0FBckIsQ0FBUDtBQUtUOzs7aUNBRW1CTixHLEVBQUtDLEcsRUFBSztBQUM1QixVQUFNTSxnQkFBYyxVQUFwQjtBQUNBLFVB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VUFBTTZCLFdBQVd4QyxnQkFBTUksSUFBTixDQUFXO0FBQUEsZUFBWUMsU0FBU00sRUFBVCxJQUFlQSxFQUEzQjtBQUFBLE9BQVgsQ0FBakI7QUFDQSxVQUFJNkIsUUFBSixFQUFjO0FBQ1osZUFBTzdDLElBQUlDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkMsbUJBQVMsZ0JBRGlCO0FBRTFCQyxnQkFBTXlDO0FBRm9CLFNBQXJCLENBQVA7QUFJRCxPQUxELE1BS087QUFDTDdDLFlBQUlDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUNuQlUsaUJBQU87QUFEWSxTQUFyQjtBQUdEO0FBQ0Y7QUFDRDs7OztrQ0FDcUJiLEcsRUFBS0MsRyxFQUFLO0FBQUEsVUFDckJnQixFQURxQixHQUNkakIsSUFBSXNDLE1BRFUsQ0FDckJyQixFQURxQjs7QUFFN0IsVUFBTThCLGFBQWEvQixxQkFBV04sSUFBWCxDQUFnQjtBQUFBLGVBQWNzQyxXQUFXL0IsRUFBWCxJQUFpQkEsRUFBL0I7QUFBQSxPQUFoQixDQUFuQjtBQUNBLFVBQUk4QixVQUFKLEVBQWdCO0FBQ2QsZUFBTzlDLElBQUlDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkMsbUJBQVMsZUFEaUI7QUFFMUI2QyxtQkFBU0Y7QUFGaUIsU0FBckIsQ0FBUDtBQUlELE9BTEQsTUFLTztBQUNMOUMsWUFBSUMsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQ25CVSxpQkFBTztBQURZLFNBQXJCO0FBR0Q7QUFDRjs7Ozs7O2tCQWNjZCxlIiwiZmlsZSI6ImNvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiQzovVXNlcnMvUElIL0RvY3VtZW50cy9jaGFsbGVuZ2UvY29udHJvbGxlciIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB1c2VycyBmcm9tIFwiLi4vbW9kZWxzL3VzZXJcIjtcclxuaW1wb3J0IGxvYW5zIGZyb20gXCIuLi9tb2RlbHMvbG9hbnNcIjtcclxuaW1wb3J0IHJlcGF5bWVudHMgZnJvbSBcIi4uL21vZGVscy9yZXBheW1lbnRzXCI7XHJcbmltcG9ydCB2YWxpZGF0aW9uUmVzdWx0IGZyb20gXCJleHByZXNzLXZhbGlkYXRvci9jaGVja1wiO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcclxuXHJcbmNsYXNzIHBvc3RzQ29udHJvbGxlciB7XHJcbiAgICBcclxuLy9nZXQgZnVuY3Rpb25cclxuICBzdGF0aWMgZ2V0bG9hbnMocmVxLCByZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICAgICAgICBzdGF0dXM6MjAwLCAgXHJcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJMaXN0IG9mIGFsbCBsb2Fuc1wiLFxyXG4gICAgICAgICAgICAgIGxvYW46IGxvYW5zXHJcbiAgICAgICAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldG5vdHJlcGFpZChyZXEsIHJlcykge1xyXG4gICAgY29uc3QgY3VycmVudHN0YXR1cz1cImFwcHJvdmVkXCI7XHJcbiAgICBjb25zdCBjdXJyZW50cmVwYWlkPWZhbHNlO1xyXG4gICAgY29uc3QgY2hlY2tub3RyZXBhaWQgPSBsb2Fucy5maW5kKG9uZWxvYW5zID0+IG9uZWxvYW5zLnN0YXR1cyA9PSBjdXJyZW50c3RhdHVzICYmIG9uZWxvYW5zLnJlcGFpZCA9PSBjdXJyZW50cmVwYWlkKTtcclxuICAgIGlmKGNoZWNrbm90cmVwYWlkKXtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgIHN0YXR1czoyMDAsICBcclxuICAgICAgbWVzc2FnZTogXCJMaXN0IG9mIGFsbCBsb2FucyB0aGF0IGFyZSBub3QgZnVsbHkgcmVwYWlkXCIsXHJcbiAgICAgIGxvYW46IGNoZWNrbm90cmVwYWlkXHJcbiAgICB9KTtcclxuICB9XHJcbiAgZWxzZXtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIHN0YXR1czo0MDQsICBcclxuICAgICAgZXJyb3I6IFwiIGNhbid0IGZpbmQgYW55IGxvYW4gdGhhdCBpcyBub3QgZnVsbHkgcmVwYWlkXCIsXHJcbiAgICAgIFxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxufVxyXG5cclxuc3RhdGljIGdldHJlcGFpZChyZXEsIHJlcykge1xyXG4gIGNvbnN0IGN1cnJlbnRzdGF0dXM9XCJhcHByb3ZlZFwiO1xyXG4gIGNvbnN0IGN1cnJlbnRyZXBhaWQ9dHJ1ZTtcclxuICBjb25zdCBjaGVja3JlcGFpZCA9IGxvYW5zLmZpbmQob25lbG9hbnMgPT4gb25lbG9hbnMuc3RhdHVzID09IGN1cnJlbnRzdGF0dXMgJiYgb25lbG9hbnMucmVwYWlkID09IGN1cnJlbnRyZXBhaWQpO1xyXG4gIGlmKGNoZWNrcmVwYWlkKXtcclxuICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgc3RhdHVzOjIwMCwgIFxyXG4gICAgbWVzc2FnZTogXCJMaXN0IG9mIGFsbCBsb2FucyB0aGF0IGFyZSAgZnVsbHkgcmVwYWlkXCIsXHJcbiAgICBsb2FuOiBjaGVja3JlcGFpZFxyXG4gIH0pO1xyXG59XHJcbmVsc2V7XHJcbiAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgIHN0YXR1czo0MDQsICBcclxuICAgIGVycm9yOiBcIiBjYW4ndCBmaW5kIGFueSBsb2FuIHRoYXQgaXMgIGZ1bGx5IHJlcGFpZFwiLFxyXG4gICAgXHJcbiAgfSk7XHJcblxyXG59XHJcbn1cclxuXHJcbiAgc3RhdGljIGdldHJlcGF5bWVudHMocmVxLCByZXMpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgIHN0YXR1czoyMDAsICBcclxuICAgICAgbWVzc2FnZTogXCJMaXN0IG9mIGFsbCByZXBheW1lbnRzXCIsXHJcbiAgICAgIGNhbmRpZGF0ZTogcmVwYXltZW50c1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuICAgIFxyXG5cclxuLy9jcmVhdGUgZnVuY3Rpb25cclxuc3RhdGljIGNyZWF0ZWxvYW5zKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCBpZCA9IHBhcnNlSW50KGxvYW5zLmxlbmd0aCkgKyAxO1xyXG4gICAgY29uc3Qge2ZpcnN0bmFtZSxsYXN0bmFtZSxlbWFpbCx0ZW5vcixhbW91bnR9ID0gcmVxLmJvZHk7XHJcbiAgICBcclxuICBjb25zdCBjaGVja2xvYW4gPSBsb2Fucy5maW5kKG9uZWxvYW5zID0+IG9uZWxvYW5zLmVtYWlsID09IHJlcS5ib2R5LmVtYWlsKTtcclxuICBpZiAoY2hlY2tsb2FuKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBcclxuICAgICAgbWVzc2FnZTogXCJsb2FuIGFscmVhZHkgZXhpc3RcIiwgIFxyXG4gICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnN0IGluc2VydGxvYW4gPSB7XHJcbiAgICAgIGlkLFxyXG4gICAgICBjcmVhdGVkT246bW9tZW50LnV0YygpLmZvcm1hdCgpLFxyXG4gICAgICBmaXJzdG5hbWUsXHJcbiAgICAgIGxhc3RuYW1lLCBcclxuICAgICAgZW1haWwsXHJcbiAgICAgIHN0YXR1czpcInBlbmRpbmdcIixcclxuICAgICAgcmVwYWlkOmZhbHNlLFxyXG4gICAgICB0ZW5vcixcclxuICAgICAgYW1vdW50LFxyXG4gICAgICBwYXltZW50SW5zdGFsbG1lbnQ6KHBhcnNlRmxvYXQocmVxLmJvZHkuYW1vdW50KStwYXJzZUZsb2F0KHJlcS5ib2R5LmFtb3VudCo1LzEwMCkpL3BhcnNlRmxvYXQocmVxLmJvZHkudGVub3IpLFxyXG4gICAgICBiYWxhbmNlOnBhcnNlRmxvYXQoKHBhcnNlRmxvYXQocmVxLmJvZHkuYW1vdW50KStwYXJzZUZsb2F0KHJlcS5ib2R5LmFtb3VudCo1LzEwMCkpL3BhcnNlRmxvYXQocmVxLmJvZHkudGVub3IpKnRlbm9yKSxcclxuICAgICAgaW50ZXJlc3Q6cmVxLmJvZHkuYW1vdW50KjUvMTAwLFxyXG4gICAgICBcclxuICAgIH07XHJcbiAgICBsb2Fucy5wdXNoKGluc2VydGxvYW4pO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXHJcbiAgICAgIHN0YXR1czoyMDAsIFxyXG4gICAgICBtZXNzYWdlOiBcImxvYW4gY3JlYXRlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgbG9hbjppbnNlcnRsb2FuXHJcbiAgICB9KTtcclxuICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgY3JlYXRlcmVwYXltZW50cyhyZXEsIHJlcykge1xyXG4gICAgY29uc3QgaWQgPSBwYXJzZUludChyZXBheW1lbnRzLmxlbmd0aCkgKyAxO1xyXG4gICAgY29uc3QgeyBsb2FuaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICBjb25zdCB7cGFpZGFtb3VudH0gPSByZXEuYm9keTtcclxuICAgIFxyXG4gICAgY29uc3QgZ2V0bG9hbiA9IGxvYW5zLmZpbmQodXBkYXRlbG9hbiA9PiB1cGRhdGVsb2FuLmlkID09IGxvYW5pZCk7XHJcbiAgaWYgKGdldGxvYW4pIHtcclxuICAgIGNvbnN0IGluc2VydHJlcGF5bWVudCA9IHtcclxuICAgICAgaWQsXHJcbiAgICAgIGNyZWF0ZWRPbjptb21lbnQudXRjKCkuZm9ybWF0KCksXHJcbiAgICAgIGxvYW5JZDpnZXRsb2FuLmlkLFxyXG4gICAgICBhbW91bnQ6Z2V0bG9hbi5hbW91bnQsXHJcbiAgICAgIG1vbnRobHlJbnN0YWxsbWVudDpnZXRsb2FuLnBheW1lbnRJbnN0YWxsbWVudCxcclxuICAgICAgcGFpZGFtb3VudCxcclxuICAgICAgYmFsYW5jZTpwYXJzZUZsb2F0KGdldGxvYW4uYmFsYW5jZSktcGFyc2VGbG9hdChyZXEuYm9keS5wYWlkYW1vdW50KSxcclxuICAgICAgXHJcbiAgICB9O1xyXG4gICAgcmVwYXltZW50cy5wdXNoKGluc2VydHJlcGF5bWVudCk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBcclxuICAgICAgc3RhdHVzOjIwMCwgXHJcbiAgICAgIG1lc3NhZ2U6IFwicGF5bWVudCBkb25lIHN1Y2Nlc3NmdWxseVwiLFxyXG4gICAgICBsb2FuOmluc2VydHJlcGF5bWVudFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBcclxuICAgICAgbWVzc2FnZTogXCJ0aGF0IGxvYW4gZG9lc24ndCBleGlzdFwiLCAgXHJcbiAgICB9KTtcclxuICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vdXBkYXRlIGZ1bmN0aW9uIChwYXRjaClcclxuc3RhdGljIHZlcmlmeWxvYW4ocmVxLCByZXMpIHtcclxuICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xyXG4gIFxyXG4gIGNvbnN0IGdldGxvYW4gPSBsb2Fucy5maW5kKHVwZGF0ZWxvYW4gPT4gdXBkYXRlbG9hbi5pZCA9PSBpZCk7XHJcbiAgaWYgKGdldGxvYW4pIHtcclxuICAgIChnZXRsb2FuLnN0YXR1cyA9IHJlcS5ib2R5LnN0YXR1cyk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiBcImxvYW4gaXMgYXBwcm92ZWQgc3VjY2VzZnVsbHlcIixcclxuICAgICAgdXBkYXRlUG9zdDogZ2V0bG9hblxyXG4gICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgZXJyb3I6IFwiY2FuJ3QgZmluZCB0aGF0IGxvYW4gd2l0aCB0aGF0IGlkXCJcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4gIFxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcblxyXG4vL2dldCBsb2FuIGJ5IGlkXHJcbnN0YXRpYyBnZXRPbmVsb2FuKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICBjb25zdCBmaW5kbG9hbiA9IGxvYW5zLmZpbmQob25lbG9hbnMgPT4gb25lbG9hbnMuaWQgPT0gaWQpO1xyXG4gIGlmIChmaW5kbG9hbikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgbWVzc2FnZTogXCJvbmUgbG9hbiBmb3VuZFwiLFxyXG4gICAgICBsb2FuOiBmaW5kbG9hblxyXG4gICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgZXJyb3I6IFwibm8gbG9hbiBmb3VuZCB3aXRoIHRoYXQgaWRcIlxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbi8vIGdldCBwYXltZW50IGJ5IGlkXHJcbnN0YXRpYyBnZXRPbmVwYXltZW50KHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICBjb25zdCBnZXRwYXltZW50ID0gcmVwYXltZW50cy5maW5kKG9uZXBheW1lbnQgPT4gb25lcGF5bWVudC5pZCA9PSBpZCk7XHJcbiAgaWYgKGdldHBheW1lbnQpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgIG1lc3NhZ2U6IFwicGF5bWVudCBmb3VuZFwiLFxyXG4gICAgICBwYXltZW50OiBnZXRwYXltZW50XHJcbiAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBlcnJvcjogXCJubyBwYXltZW50IGZvdW5kIHdpdGggdGhhdCBpZFwiXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBwb3N0c0NvbnRyb2xsZXI7Il19