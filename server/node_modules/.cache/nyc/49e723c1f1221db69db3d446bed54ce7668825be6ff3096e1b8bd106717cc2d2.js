'use strict';var cov_23bluhnxjf=function(){var path="C:\\Users\\PIH\\Documents\\challenge\\controller\\controller.js";var hash="041127ddd732433ac727eed5d7449ab265878a1c";var Function=function(){}.constructor;var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\PIH\\Documents\\challenge\\controller\\controller.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:19},end:{line:7,column:563}},"2":{start:{line:7,column:76},end:{line:7,column:347}},"3":{start:{line:7,column:89},end:{line:7,column:90}},"4":{start:{line:7,column:134},end:{line:7,column:142}},"5":{start:{line:7,column:144},end:{line:7,column:199}},"6":{start:{line:7,column:200},end:{line:7,column:231}},"7":{start:{line:7,column:232},end:{line:7,column:286}},"8":{start:{line:7,column:259},end:{line:7,column:286}},"9":{start:{line:7,column:287},end:{line:7,column:345}},"10":{start:{line:7,column:350},end:{line:7,column:559}},"11":{start:{line:7,column:407},end:{line:7,column:475}},"12":{start:{line:7,column:423},end:{line:7,column:475}},"13":{start:{line:7,column:476},end:{line:7,column:536}},"14":{start:{line:7,column:493},end:{line:7,column:536}},"15":{start:{line:7,column:537},end:{line:7,column:556}},"16":{start:{line:11,column:13},end:{line:11,column:47}},"17":{start:{line:13,column:14},end:{line:13,column:44}},"18":{start:{line:15,column:14},end:{line:15,column:31}},"19":{start:{line:17,column:15},end:{line:17,column:46}},"20":{start:{line:19,column:11},end:{line:19,column:25}},"21":{start:{line:21,column:12},end:{line:21,column:40}},"22":{start:{line:23,column:18},end:{line:23,column:49}},"23":{start:{line:25,column:19},end:{line:25,column:54}},"24":{start:{line:27,column:13},end:{line:27,column:39}},"25":{start:{line:29,column:14},end:{line:29,column:44}},"26":{start:{line:31,column:23},end:{line:31,column:60}},"27":{start:{line:33,column:24},end:{line:33,column:64}},"28":{start:{line:35,column:39},end:{line:35,column:93}},"29":{start:{line:37,column:50},end:{line:37,column:151}},"30":{start:{line:37,column:92},end:{line:37,column:149}},"31":{start:{line:39,column:22},end:{line:341,column:3}},"32":{start:{line:41,column:4},end:{line:41,column:43}},"33":{start:{line:44,column:2},end:{line:338,column:6}},"34":{start:{line:49,column:6},end:{line:53,column:9}},"35":{start:{line:58,column:26},end:{line:58,column:36}},"36":{start:{line:59,column:26},end:{line:59,column:31}},"37":{start:{line:60,column:27},end:{line:62,column:8}},"38":{start:{line:61,column:8},end:{line:61,column:84}},"39":{start:{line:63,column:6},end:{line:69,column:7}},"40":{start:{line:64,column:8},end:{line:68,column:11}},"41":{start:{line:71,column:6},end:{line:75,column:9}},"42":{start:{line:80,column:26},end:{line:80,column:36}},"43":{start:{line:81,column:26},end:{line:81,column:30}},"44":{start:{line:82,column:24},end:{line:84,column:8}},"45":{start:{line:83,column:8},end:{line:83,column:84}},"46":{start:{line:85,column:6},end:{line:91,column:7}},"47":{start:{line:86,column:8},end:{line:90,column:11}},"48":{start:{line:93,column:6},end:{line:97,column:9}},"49":{start:{line:102,column:6},end:{line:106,column:9}},"50":{start:{line:114,column:15},end:{line:114,column:51}},"51":{start:{line:115,column:22},end:{line:115,column:30}},"52":{start:{line:116,column:22},end:{line:116,column:41}},"53":{start:{line:117,column:21},end:{line:117,column:39}},"54":{start:{line:118,column:18},end:{line:118,column:33}},"55":{start:{line:119,column:18},end:{line:119,column:33}},"56":{start:{line:120,column:19},end:{line:120,column:35}},"57":{start:{line:122,column:26},end:{line:128,column:46}},"58":{start:{line:129,column:18},end:{line:129,column:37}},"59":{start:{line:130,column:18},end:{line:130,column:37}},"60":{start:{line:132,column:6},end:{line:167,column:7}},"61":{start:{line:133,column:8},end:{line:133,column:66}},"62":{start:{line:135,column:24},end:{line:135,column:56}},"63":{start:{line:137,column:8},end:{line:142,column:9}},"64":{start:{line:138,column:10},end:{line:141,column:13}},"65":{start:{line:144,column:23},end:{line:144,column:59}},"66":{start:{line:162,column:8},end:{line:166,column:11}},"67":{start:{line:174,column:15},end:{line:174,column:56}},"68":{start:{line:175,column:19},end:{line:175,column:36}},"69":{start:{line:176,column:23},end:{line:176,column:42}},"70":{start:{line:178,column:27},end:{line:180,column:52}},"71":{start:{line:181,column:18},end:{line:181,column:38}},"72":{start:{line:182,column:18},end:{line:182,column:38}},"73":{start:{line:184,column:6},end:{line:228,column:7}},"74":{start:{line:185,column:8},end:{line:185,column:66}},"75":{start:{line:190,column:22},end:{line:190,column:53}},"76":{start:{line:191,column:8},end:{line:223,column:9}},"77":{start:{line:192,column:10},end:{line:197,column:11}},"78":{start:{line:193,column:12},end:{line:196,column:15}},"79":{start:{line:198,column:10},end:{line:203,column:11}},"80":{start:{line:199,column:12},end:{line:202,column:15}},"81":{start:{line:205,column:26},end:{line:205,column:81}},"82":{start:{line:218,column:10},end:{line:222,column:13}},"83":{start:{line:224,column:8},end:{line:227,column:11}},"84":{start:{line:236,column:15},end:{line:236,column:28}},"85":{start:{line:237,column:19},end:{line:237,column:34}},"86":{start:{line:239,column:27},end:{line:241,column:49}},"87":{start:{line:242,column:18},end:{line:242,column:38}},"88":{start:{line:243,column:18},end:{line:243,column:38}},"89":{start:{line:245,column:6},end:{line:261,column:7}},"90":{start:{line:246,column:8},end:{line:246,column:66}},"91":{start:{line:248,column:22},end:{line:248,column:49}},"92":{start:{line:249,column:8},end:{line:256,column:9}},"93":{start:{line:250,column:10},end:{line:250,column:34}},"94":{start:{line:251,column:10},end:{line:255,column:13}},"95":{start:{line:257,column:8},end:{line:260,column:11}},"96":{start:{line:274,column:15},end:{line:274,column:28}},"97":{start:{line:276,column:21},end:{line:276,column:48}},"98":{start:{line:280,column:6},end:{line:286,column:7}},"99":{start:{line:281,column:8},end:{line:285,column:11}},"100":{start:{line:287,column:6},end:{line:290,column:9}},"101":{start:{line:298,column:15},end:{line:298,column:28}},"102":{start:{line:300,column:23},end:{line:300,column:63}},"103":{start:{line:302,column:6},end:{line:307,column:7}},"104":{start:{line:303,column:8},end:{line:306,column:11}},"105":{start:{line:308,column:6},end:{line:311,column:9}},"106":{start:{line:316,column:15},end:{line:316,column:28}},"107":{start:{line:318,column:21},end:{line:320,column:8}},"108":{start:{line:319,column:8},end:{line:319,column:29}},"109":{start:{line:321,column:6},end:{line:336,column:7}},"110":{start:{line:322,column:8},end:{line:322,column:44}},"111":{start:{line:323,column:22},end:{line:325,column:10}},"112":{start:{line:324,column:10},end:{line:324,column:35}},"113":{start:{line:326,column:8},end:{line:330,column:11}},"114":{start:{line:332,column:8},end:{line:335,column:11}},"115":{start:{line:340,column:2},end:{line:340,column:25}},"116":{start:{line:343,column:0},end:{line:343,column:34}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:19},end:{line:7,column:20}},loc:{start:{line:7,column:31},end:{line:7,column:561}},line:7},"1":{name:"defineProperties",decl:{start:{line:7,column:42},end:{line:7,column:58}},loc:{start:{line:7,column:74},end:{line:7,column:349}},line:7},"2":{name:"(anonymous_2)",decl:{start:{line:7,column:357},end:{line:7,column:358}},loc:{start:{line:7,column:405},end:{line:7,column:558}},line:7},"3":{name:"_interopRequireDefault",decl:{start:{line:35,column:9},end:{line:35,column:31}},loc:{start:{line:35,column:37},end:{line:35,column:95}},line:35},"4":{name:"_classCallCheck",decl:{start:{line:37,column:9},end:{line:37,column:24}},loc:{start:{line:37,column:48},end:{line:37,column:153}},line:37},"5":{name:"(anonymous_5)",decl:{start:{line:39,column:22},end:{line:39,column:23}},loc:{start:{line:39,column:34},end:{line:341,column:1}},line:39},"6":{name:"postsController",decl:{start:{line:40,column:11},end:{line:40,column:26}},loc:{start:{line:40,column:29},end:{line:42,column:3}},line:40},"7":{name:"getloans",decl:{start:{line:48,column:20},end:{line:48,column:28}},loc:{start:{line:48,column:39},end:{line:54,column:5}},line:48},"8":{name:"getnotrepaid",decl:{start:{line:57,column:20},end:{line:57,column:32}},loc:{start:{line:57,column:43},end:{line:76,column:5}},line:57},"9":{name:"(anonymous_9)",decl:{start:{line:60,column:48},end:{line:60,column:49}},loc:{start:{line:60,column:68},end:{line:62,column:7}},line:60},"10":{name:"getrepaid",decl:{start:{line:79,column:20},end:{line:79,column:29}},loc:{start:{line:79,column:40},end:{line:98,column:5}},line:79},"11":{name:"(anonymous_11)",decl:{start:{line:82,column:45},end:{line:82,column:46}},loc:{start:{line:82,column:65},end:{line:84,column:7}},line:82},"12":{name:"getrepayments",decl:{start:{line:101,column:20},end:{line:101,column:33}},loc:{start:{line:101,column:44},end:{line:107,column:5}},line:101},"13":{name:"createloans",decl:{start:{line:113,column:20},end:{line:113,column:31}},loc:{start:{line:113,column:42},end:{line:168,column:5}},line:113},"14":{name:"createrepayments",decl:{start:{line:173,column:20},end:{line:173,column:36}},loc:{start:{line:173,column:47},end:{line:229,column:5}},line:173},"15":{name:"verifyloan",decl:{start:{line:235,column:20},end:{line:235,column:30}},loc:{start:{line:235,column:41},end:{line:262,column:5}},line:235},"16":{name:"getOneloan",decl:{start:{line:273,column:20},end:{line:273,column:30}},loc:{start:{line:273,column:41},end:{line:291,column:5}},line:273},"17":{name:"getOnepayment",decl:{start:{line:297,column:20},end:{line:297,column:33}},loc:{start:{line:297,column:44},end:{line:312,column:5}},line:297},"18":{name:"deleteloan",decl:{start:{line:315,column:20},end:{line:315,column:30}},loc:{start:{line:315,column:41},end:{line:337,column:5}},line:315},"19":{name:"(anonymous_19)",decl:{start:{line:318,column:47},end:{line:318,column:48}},loc:{start:{line:318,column:63},end:{line:320,column:7}},line:318},"20":{name:"(anonymous_20)",decl:{start:{line:323,column:45},end:{line:323,column:46}},loc:{start:{line:323,column:61},end:{line:325,column:9}},line:323}},branchMap:{"0":{loc:{start:{line:7,column:168},end:{line:7,column:198}},type:"binary-expr",locations:[{start:{line:7,column:168},end:{line:7,column:189}},{start:{line:7,column:193},end:{line:7,column:198}}],line:7},"1":{loc:{start:{line:7,column:232},end:{line:7,column:286}},type:"if",locations:[{start:{line:7,column:232},end:{line:7,column:286}},{start:{line:7,column:232},end:{line:7,column:286}}],line:7},"2":{loc:{start:{line:7,column:407},end:{line:7,column:475}},type:"if",locations:[{start:{line:7,column:407},end:{line:7,column:475}},{start:{line:7,column:407},end:{line:7,column:475}}],line:7},"3":{loc:{start:{line:7,column:476},end:{line:7,column:536}},type:"if",locations:[{start:{line:7,column:476},end:{line:7,column:536}},{start:{line:7,column:476},end:{line:7,column:536}}],line:7},"4":{loc:{start:{line:35,column:46},end:{line:35,column:92}},type:"cond-expr",locations:[{start:{line:35,column:70},end:{line:35,column:73}},{start:{line:35,column:76},end:{line:35,column:92}}],line:35},"5":{loc:{start:{line:35,column:46},end:{line:35,column:67}},type:"binary-expr",locations:[{start:{line:35,column:46},end:{line:35,column:49}},{start:{line:35,column:53},end:{line:35,column:67}}],line:35},"6":{loc:{start:{line:37,column:50},end:{line:37,column:151}},type:"if",locations:[{start:{line:37,column:50},end:{line:37,column:151}},{start:{line:37,column:50},end:{line:37,column:151}}],line:37},"7":{loc:{start:{line:61,column:15},end:{line:61,column:83}},type:"binary-expr",locations:[{start:{line:61,column:15},end:{line:61,column:47}},{start:{line:61,column:51},end:{line:61,column:83}}],line:61},"8":{loc:{start:{line:63,column:6},end:{line:69,column:7}},type:"if",locations:[{start:{line:63,column:6},end:{line:69,column:7}},{start:{line:63,column:6},end:{line:69,column:7}}],line:63},"9":{loc:{start:{line:83,column:15},end:{line:83,column:83}},type:"binary-expr",locations:[{start:{line:83,column:15},end:{line:83,column:47}},{start:{line:83,column:51},end:{line:83,column:83}}],line:83},"10":{loc:{start:{line:85,column:6},end:{line:91,column:7}},type:"if",locations:[{start:{line:85,column:6},end:{line:91,column:7}},{start:{line:85,column:6},end:{line:91,column:7}}],line:85},"11":{loc:{start:{line:132,column:6},end:{line:167,column:7}},type:"if",locations:[{start:{line:132,column:6},end:{line:167,column:7}},{start:{line:132,column:6},end:{line:167,column:7}}],line:132},"12":{loc:{start:{line:137,column:8},end:{line:142,column:9}},type:"if",locations:[{start:{line:137,column:8},end:{line:142,column:9}},{start:{line:137,column:8},end:{line:142,column:9}}],line:137},"13":{loc:{start:{line:184,column:6},end:{line:228,column:7}},type:"if",locations:[{start:{line:184,column:6},end:{line:228,column:7}},{start:{line:184,column:6},end:{line:228,column:7}}],line:184},"14":{loc:{start:{line:191,column:8},end:{line:223,column:9}},type:"if",locations:[{start:{line:191,column:8},end:{line:223,column:9}},{start:{line:191,column:8},end:{line:223,column:9}}],line:191},"15":{loc:{start:{line:192,column:10},end:{line:197,column:11}},type:"if",locations:[{start:{line:192,column:10},end:{line:197,column:11}},{start:{line:192,column:10},end:{line:197,column:11}}],line:192},"16":{loc:{start:{line:198,column:10},end:{line:203,column:11}},type:"if",locations:[{start:{line:198,column:10},end:{line:203,column:11}},{start:{line:198,column:10},end:{line:203,column:11}}],line:198},"17":{loc:{start:{line:245,column:6},end:{line:261,column:7}},type:"if",locations:[{start:{line:245,column:6},end:{line:261,column:7}},{start:{line:245,column:6},end:{line:261,column:7}}],line:245},"18":{loc:{start:{line:249,column:8},end:{line:256,column:9}},type:"if",locations:[{start:{line:249,column:8},end:{line:256,column:9}},{start:{line:249,column:8},end:{line:256,column:9}}],line:249},"19":{loc:{start:{line:280,column:6},end:{line:286,column:7}},type:"if",locations:[{start:{line:280,column:6},end:{line:286,column:7}},{start:{line:280,column:6},end:{line:286,column:7}}],line:280},"20":{loc:{start:{line:302,column:6},end:{line:307,column:7}},type:"if",locations:[{start:{line:302,column:6},end:{line:307,column:7}},{start:{line:302,column:6},end:{line:307,column:7}}],line:302},"21":{loc:{start:{line:321,column:6},end:{line:336,column:7}},type:"if",locations:[{start:{line:321,column:6},end:{line:336,column:7}},{start:{line:321,column:6},end:{line:336,column:7}}],line:321}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_23bluhnxjf.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _createClass=(cov_23bluhnxjf.s[1]++,function(){cov_23bluhnxjf.f[0]++;function defineProperties(target,props){cov_23bluhnxjf.f[1]++;cov_23bluhnxjf.s[2]++;for(var i=(cov_23bluhnxjf.s[3]++,0);i<props.length;i++){var descriptor=(cov_23bluhnxjf.s[4]++,props[i]);cov_23bluhnxjf.s[5]++;descriptor.enumerable=(cov_23bluhnxjf.b[0][0]++,descriptor.enumerable)||(cov_23bluhnxjf.b[0][1]++,false);cov_23bluhnxjf.s[6]++;descriptor.configurable=true;cov_23bluhnxjf.s[7]++;if("value"in descriptor){cov_23bluhnxjf.b[1][0]++;cov_23bluhnxjf.s[8]++;descriptor.writable=true;}else{cov_23bluhnxjf.b[1][1]++;}cov_23bluhnxjf.s[9]++;Object.defineProperty(target,descriptor.key,descriptor);}}cov_23bluhnxjf.s[10]++;return function(Constructor,protoProps,staticProps){cov_23bluhnxjf.f[2]++;cov_23bluhnxjf.s[11]++;if(protoProps){cov_23bluhnxjf.b[2][0]++;cov_23bluhnxjf.s[12]++;defineProperties(Constructor.prototype,protoProps);}else{cov_23bluhnxjf.b[2][1]++;}cov_23bluhnxjf.s[13]++;if(staticProps){cov_23bluhnxjf.b[3][0]++;cov_23bluhnxjf.s[14]++;defineProperties(Constructor,staticProps);}else{cov_23bluhnxjf.b[3][1]++;}cov_23bluhnxjf.s[15]++;return Constructor;};}());// import loans from "../db/loans";
// import repayments from "../db/repayments";
var _check=(cov_23bluhnxjf.s[16]++,require('express-validator/check'));var _check2=(cov_23bluhnxjf.s[17]++,_interopRequireDefault(_check));var _moment=(cov_23bluhnxjf.s[18]++,require('moment'));var _moment2=(cov_23bluhnxjf.s[19]++,_interopRequireDefault(_moment));var _joi=(cov_23bluhnxjf.s[20]++,require('joi'));var _joi2=(cov_23bluhnxjf.s[21]++,_interopRequireDefault(_joi));var _repayments=(cov_23bluhnxjf.s[22]++,require('../models/repayments'));var _repayments2=(cov_23bluhnxjf.s[23]++,_interopRequireDefault(_repayments));var _loans=(cov_23bluhnxjf.s[24]++,require('../models/loans'));var _loans2=(cov_23bluhnxjf.s[25]++,_interopRequireDefault(_loans));var _inputvalidation=(cov_23bluhnxjf.s[26]++,require('../helpers/inputvalidation'));var _inputvalidation2=(cov_23bluhnxjf.s[27]++,_interopRequireDefault(_inputvalidation));function _interopRequireDefault(obj){cov_23bluhnxjf.f[3]++;cov_23bluhnxjf.s[28]++;return(cov_23bluhnxjf.b[5][0]++,obj)&&(cov_23bluhnxjf.b[5][1]++,obj.__esModule)?(cov_23bluhnxjf.b[4][0]++,obj):(cov_23bluhnxjf.b[4][1]++,{default:obj});}function _classCallCheck(instance,Constructor){cov_23bluhnxjf.f[4]++;cov_23bluhnxjf.s[29]++;if(!(instance instanceof Constructor)){cov_23bluhnxjf.b[6][0]++;cov_23bluhnxjf.s[30]++;throw new TypeError("Cannot call a class as a function");}else{cov_23bluhnxjf.b[6][1]++;}}var postsController=(cov_23bluhnxjf.s[31]++,function(){cov_23bluhnxjf.f[5]++;function postsController(){cov_23bluhnxjf.f[6]++;cov_23bluhnxjf.s[32]++;_classCallCheck(this,postsController);}cov_23bluhnxjf.s[33]++;_createClass(postsController,null,[{key:'getloans',// get function
value:function getloans(req,res){cov_23bluhnxjf.f[7]++;cov_23bluhnxjf.s[34]++;return res.status(200).json({status:200,message:'List of all loans',loan:_loans2.default});}},{key:'getnotrepaid',value:function getnotrepaid(req,res){cov_23bluhnxjf.f[8]++;var currentstatus=(cov_23bluhnxjf.s[35]++,'approved');var currentrepaid=(cov_23bluhnxjf.s[36]++,false);var checknotrepaid=(cov_23bluhnxjf.s[37]++,_loans2.default.find(function(oneloans){cov_23bluhnxjf.f[9]++;cov_23bluhnxjf.s[38]++;return(cov_23bluhnxjf.b[7][0]++,oneloans.status==currentstatus)&&(cov_23bluhnxjf.b[7][1]++,oneloans.repaid==currentrepaid);}));cov_23bluhnxjf.s[39]++;if(checknotrepaid){cov_23bluhnxjf.b[8][0]++;cov_23bluhnxjf.s[40]++;return res.status(200).json({status:200,message:'List of all loans that are not fully repaid',loan:checknotrepaid});}else{cov_23bluhnxjf.b[8][1]++;}cov_23bluhnxjf.s[41]++;return res.status(404).json({status:404,message:" can't find any loan that is not fully repaid"});}},{key:'getrepaid',value:function getrepaid(req,res){cov_23bluhnxjf.f[10]++;var currentstatus=(cov_23bluhnxjf.s[42]++,'approved');var currentrepaid=(cov_23bluhnxjf.s[43]++,true);var checkrepaid=(cov_23bluhnxjf.s[44]++,_loans2.default.find(function(oneloans){cov_23bluhnxjf.f[11]++;cov_23bluhnxjf.s[45]++;return(cov_23bluhnxjf.b[9][0]++,oneloans.status==currentstatus)&&(cov_23bluhnxjf.b[9][1]++,oneloans.repaid==currentrepaid);}));cov_23bluhnxjf.s[46]++;if(checkrepaid){cov_23bluhnxjf.b[10][0]++;cov_23bluhnxjf.s[47]++;return res.status(200).json({status:200,message:'List of all loans that are  fully repaid',loan:checkrepaid});}else{cov_23bluhnxjf.b[10][1]++;}cov_23bluhnxjf.s[48]++;return res.status(404).json({status:404,message:" can't find any loan that is  fully repaid"});}},{key:'getrepayments',value:function getrepayments(req,res){cov_23bluhnxjf.f[12]++;cov_23bluhnxjf.s[49]++;return res.status(200).json({status:200,message:'List of all repayments',repayment:_repayments2.default});}// create function
},{key:'createloans',value:function createloans(req,res){cov_23bluhnxjf.f[13]++;var id=(cov_23bluhnxjf.s[50]++,parseInt(_loans2.default.length)+1);var _req$body=(cov_23bluhnxjf.s[51]++,req.body),firstname=(cov_23bluhnxjf.s[52]++,_req$body.firstname),lastname=(cov_23bluhnxjf.s[53]++,_req$body.lastname),email=(cov_23bluhnxjf.s[54]++,_req$body.email),tenor=(cov_23bluhnxjf.s[55]++,_req$body.tenor),amount=(cov_23bluhnxjf.s[56]++,_req$body.amount);var _joi$validate=(cov_23bluhnxjf.s[57]++,_joi2.default.validate({firstname:firstname,lastname:lastname,email:email,tenor:tenor,amount:amount},_inputvalidation2.default.loanSchema)),error=(cov_23bluhnxjf.s[58]++,_joi$validate.error),value=(cov_23bluhnxjf.s[59]++,_joi$validate.value);cov_23bluhnxjf.s[60]++;if(error){cov_23bluhnxjf.b[11][0]++;cov_23bluhnxjf.s[61]++;res.status(400).send({error:error.details[0].message});}else{cov_23bluhnxjf.b[11][1]++;var checkloan=(cov_23bluhnxjf.s[62]++,_loans2.default.findEmail(email));// const checkloan = loans.find(oneloans => oneloans.email == req.body.email);
cov_23bluhnxjf.s[63]++;if(checkloan){cov_23bluhnxjf.b[12][0]++;cov_23bluhnxjf.s[64]++;return res.status(400).json({status:400,message:'loan already exist'});}else{cov_23bluhnxjf.b[12][1]++;}var loanInfo=(cov_23bluhnxjf.s[65]++,_loans2.default.createLoan(req.body));/*
        const insertloan = {
        id,
        createdOn:moment.utc().format('DD-MM-YYYY HH:MM:SS'),
        firstname,
        lastname,
        email,
        status:"pending",
        repaid:false,
        tenor,
        amount,
        paymentInstallment:(parseFloat(req.body.amount)+parseFloat(req.body.amount*5/100))/parseFloat(req.body.tenor),
        balance:parseFloat((parseFloat(req.body.amount)+parseFloat(req.body.amount*5/100))/parseFloat(req.body.tenor)*tenor),
        interest:req.body.amount*5/100,
        };
        loans.push(insertloan);
        */cov_23bluhnxjf.s[66]++;return res.status(200).json({status:200,message:'loan created successfully',loan:loanInfo});}}// create repayments function
},{key:'createrepayments',value:function createrepayments(req,res){cov_23bluhnxjf.f[14]++;var id=(cov_23bluhnxjf.s[67]++,parseInt(_repayments2.default.length)+1);var loanid=(cov_23bluhnxjf.s[68]++,req.params.loanid);var paidamount=(cov_23bluhnxjf.s[69]++,req.body.paidamount);var _joi$validate2=(cov_23bluhnxjf.s[70]++,_joi2.default.validate({paidamount:paidamount},_inputvalidation2.default.paidamountSchema)),error=(cov_23bluhnxjf.s[71]++,_joi$validate2.error),value=(cov_23bluhnxjf.s[72]++,_joi$validate2.value);cov_23bluhnxjf.s[73]++;if(error){cov_23bluhnxjf.b[13][0]++;cov_23bluhnxjf.s[74]++;res.status(400).send({error:error.details[0].message});}else{cov_23bluhnxjf.b[13][1]++;// const getrepayments=model1.findpaymentloanid(loanid);
// const getloan = model.findOne(loanid)
// const getrepayments=repayments.find(getloanpayments=>getloanpayments.loanId== parseInt(loanid));
var getloan=(cov_23bluhnxjf.s[75]++,_loans2.default.findOne(loanid));cov_23bluhnxjf.s[76]++;if(getloan){cov_23bluhnxjf.b[14][0]++;cov_23bluhnxjf.s[77]++;if(parseFloat(getloan.balance)<paidamount){cov_23bluhnxjf.b[15][0]++;cov_23bluhnxjf.s[78]++;return res.status(400).json({status:400,message:'you payed much money than that you must pay on the balance !'});}else{cov_23bluhnxjf.b[15][1]++;}cov_23bluhnxjf.s[79]++;if(getloan.status!='approved'){cov_23bluhnxjf.b[16][0]++;cov_23bluhnxjf.s[80]++;return res.status(400).json({status:400,message:'this is not approved !'});}else{cov_23bluhnxjf.b[16][1]++;}var Repayment=(cov_23bluhnxjf.s[81]++,_repayments2.default.createRepayments(req.body,loanid));/* const insertrepayment = {
           id,
           createdOn:moment.utc().format('DD-MM-YYYY HH:MM:SS'),
           loanId:getloan.id,
           amount:getloan.amount,
           monthlyInstallment:getloan.paymentInstallment,
           paidamount,
           balance:parseFloat(getrepayments.balance)-parseFloat(req.body.paidamount),
          };
          repayments.push(insertrepayment);
          */cov_23bluhnxjf.s[82]++;return res.status(200).json({status:200,message:'payment done successfully',loan:Repayment});}else{cov_23bluhnxjf.b[14][1]++;}cov_23bluhnxjf.s[83]++;return res.status(400).json({status:400,message:"that loan doesn't exist"});}}// update function (patch)
},{key:'verifyloan',value:function verifyloan(req,res){cov_23bluhnxjf.f[15]++;var id=(cov_23bluhnxjf.s[84]++,req.params.id);var status=(cov_23bluhnxjf.s[85]++,req.body.status);var _joi$validate3=(cov_23bluhnxjf.s[86]++,_joi2.default.validate({status:status},_inputvalidation2.default.approveSchema)),error=(cov_23bluhnxjf.s[87]++,_joi$validate3.error),value=(cov_23bluhnxjf.s[88]++,_joi$validate3.value);cov_23bluhnxjf.s[89]++;if(error){cov_23bluhnxjf.b[17][0]++;cov_23bluhnxjf.s[90]++;res.status(400).send({error:error.details[0].message});}else{cov_23bluhnxjf.b[17][1]++;var getloan=(cov_23bluhnxjf.s[91]++,_loans2.default.findOne(id));cov_23bluhnxjf.s[92]++;if(getloan){cov_23bluhnxjf.b[18][0]++;cov_23bluhnxjf.s[93]++;getloan.status=status;cov_23bluhnxjf.s[94]++;return res.status(201).json({status:201,message:'loan is approved succesfully',updatePost:getloan});}else{cov_23bluhnxjf.b[18][1]++;}cov_23bluhnxjf.s[95]++;res.status(400).json({status:400,error:"can't find that loan with that id"});}}// //////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////
// get loan by id
},{key:'getOneloan',value:function getOneloan(req,res){cov_23bluhnxjf.f[16]++;var id=(cov_23bluhnxjf.s[96]++,req.params.id);var findloan=(cov_23bluhnxjf.s[97]++,_loans2.default.findOne(id));/*
      const findloan = loans.find(oneloans => oneloans.id == id);
      */cov_23bluhnxjf.s[98]++;if(findloan){cov_23bluhnxjf.b[19][0]++;cov_23bluhnxjf.s[99]++;return res.status(200).json({status:400,message:'one loan found',loan:findloan});}else{cov_23bluhnxjf.b[19][1]++;}cov_23bluhnxjf.s[100]++;res.status(400).json({status:400,error:'no loan found with that id'});}// get payment by id
},{key:'getOnepayment',value:function getOnepayment(req,res){cov_23bluhnxjf.f[17]++;var id=(cov_23bluhnxjf.s[101]++,req.params.id);var getpayment=(cov_23bluhnxjf.s[102]++,_repayments2.default.findOnepayments(id));// const getpayment = repayments.find(onepayment => onepayment.id == id);
cov_23bluhnxjf.s[103]++;if(getpayment){cov_23bluhnxjf.b[20][0]++;cov_23bluhnxjf.s[104]++;return res.status(200).json({message:'payment found',payment:getpayment});}else{cov_23bluhnxjf.b[20][1]++;}cov_23bluhnxjf.s[105]++;res.status(400).json({status:400,error:'no payment found with that id'});}},{key:'deleteloan',value:function deleteloan(req,res){cov_23bluhnxjf.f[18]++;var id=(cov_23bluhnxjf.s[106]++,req.params.id);var findloan=(cov_23bluhnxjf.s[107]++,_loans2.default.findIndex(function(loan){cov_23bluhnxjf.f[19]++;cov_23bluhnxjf.s[108]++;return loan.id==id;}));cov_23bluhnxjf.s[109]++;if(findloan>-1){cov_23bluhnxjf.b[21][0]++;cov_23bluhnxjf.s[110]++;_loans2.default.splice(findloan,1);var newloan=(cov_23bluhnxjf.s[111]++,_loans2.default.filter(function(loan){cov_23bluhnxjf.f[20]++;cov_23bluhnxjf.s[112]++;return loan!==findloan;}));cov_23bluhnxjf.s[113]++;res.status(200).json({status:200,message:'loan successfully deleted',loan:newloan});}else{cov_23bluhnxjf.b[21][1]++;cov_23bluhnxjf.s[114]++;res.status(400).json({status:400,error:'could not find that loan'});}}}]);cov_23bluhnxjf.s[115]++;return postsController;}());cov_23bluhnxjf.s[116]++;exports.default=postsController;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsicG9zdHNDb250cm9sbGVyIiwicmVxIiwicmVzIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJsb2FuIiwibG9hbnMiLCJjdXJyZW50c3RhdHVzIiwiY3VycmVudHJlcGFpZCIsImNoZWNrbm90cmVwYWlkIiwiZmluZCIsIm9uZWxvYW5zIiwicmVwYWlkIiwiY2hlY2tyZXBhaWQiLCJyZXBheW1lbnQiLCJyZXBheW1lbnRzIiwiaWQiLCJwYXJzZUludCIsImxlbmd0aCIsImJvZHkiLCJmaXJzdG5hbWUiLCJsYXN0bmFtZSIsImVtYWlsIiwidGVub3IiLCJhbW91bnQiLCJqb2kiLCJ2YWxpZGF0ZSIsIlNjaGVtYSIsImxvYW5TY2hlbWEiLCJlcnJvciIsInZhbHVlIiwic2VuZCIsImRldGFpbHMiLCJjaGVja2xvYW4iLCJtb2RlbCIsImZpbmRFbWFpbCIsImxvYW5JbmZvIiwiY3JlYXRlTG9hbiIsImxvYW5pZCIsInBhcmFtcyIsInBhaWRhbW91bnQiLCJwYWlkYW1vdW50U2NoZW1hIiwiZ2V0bG9hbiIsImZpbmRPbmUiLCJwYXJzZUZsb2F0IiwiYmFsYW5jZSIsIlJlcGF5bWVudCIsIm1vZGVsMSIsImNyZWF0ZVJlcGF5bWVudHMiLCJhcHByb3ZlU2NoZW1hIiwidXBkYXRlUG9zdCIsImZpbmRsb2FuIiwiZ2V0cGF5bWVudCIsImZpbmRPbmVwYXltZW50cyIsInBheW1lbnQiLCJmaW5kSW5kZXgiLCJzcGxpY2UiLCJuZXdsb2FuIiwiZmlsdGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7cWpCQUFBO0FBQ0E7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7SUFJTUEsZTs7Ozs7Ozs7QUFDTjs2QkFDa0JDLEcsRUFBS0MsRyxFQUFLO0FBQ3hCLGFBQU9BLElBQUlDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkQsZ0JBQVEsR0FEa0I7QUFF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LENBQW5CO0FBQ0E7QUFDQSxVQUFJb0MsVUFBSixFQUFnQjtBQUNkLGVBQU9uRCxJQUFJQyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDMUJDLG1CQUFTLGVBRGlCO0FBRTFCa0QsbUJBQVNGO0FBRmlCLFNBQXJCLENBQVA7QUFJRDtBQUNEbkQsVUFBSUMsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQ25CRCxnQkFBUSxHQURXO0FBRW5CMkIsZUFBTztBQUZZLE9BQXJCO0FBSUQ7OzsrQkFFaUI3QixHLEVBQUtDLEcsRUFBSztBQUFBLFVBQ2xCZSxFQURrQixHQUNYaEIsSUFBSXVDLE1BRE8sQ0FDbEJ2QixFQURrQjs7QUFFMUIsVUFBTW1DLFdBQVc3QyxnQkFBTWlELFNBQU4sQ0FBZ0I7QUFBQSxlQUFRbEQsS0FBS1csRUFBTCxJQUFXQSxFQUFuQjtBQUFBLE9BQWhCLENBQWpCO0FBQ0EsVUFBSW1DLFdBQVcsQ0FBQyxDQUFoQixFQUFtQjtBQUNqQjdDLHdCQUFNa0QsTUFBTixDQUFhTCxRQUFiLEVBQXVCLENBQXZCO0FBQ0EsWUFBTU0sVUFBVW5ELGdCQUFNb0QsTUFBTixDQUFhO0FBQUEsaUJBQVFyRCxTQUFTOEMsUUFBakI7QUFBQSxTQUFiLENBQWhCO0FBQ0FsRCxZQUFJQyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDbkJELGtCQUFRLEdBRFc7QUFFbkJFLG1CQUFTLDJCQUZVO0FBR25CQyxnQkFBTW9EO0FBSGEsU0FBckI7QUFLRCxPQVJELE1BUU87QUFDTHhELFlBQUlDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUNuQkQsa0JBQVEsR0FEVztBQUVuQjJCLGlCQUFPO0FBRlksU0FBckI7QUFJRDtBQUNGOzs7Ozs7a0JBSVk5QixlIiwiZmlsZSI6ImNvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiQzovVXNlcnMvUElIL0RvY3VtZW50cy9jaGFsbGVuZ2UvY29udHJvbGxlciIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCBsb2FucyBmcm9tIFwiLi4vZGIvbG9hbnNcIjtcbi8vIGltcG9ydCByZXBheW1lbnRzIGZyb20gXCIuLi9kYi9yZXBheW1lbnRzXCI7XG5pbXBvcnQgdmFsaWRhdGlvblJlc3VsdCBmcm9tICdleHByZXNzLXZhbGlkYXRvci9jaGVjayc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgam9pIGZyb20gJ2pvaSc7XG5pbXBvcnQgcmVwYXltZW50cyBmcm9tICcuLi9tb2RlbHMvcmVwYXltZW50cyc7XG5pbXBvcnQgbG9hbnMgZnJvbSAnLi4vbW9kZWxzL2xvYW5zJztcbmltcG9ydCBTY2hlbWEgZnJvbSAnLi4vaGVscGVycy9pbnB1dHZhbGlkYXRpb24nO1xuaW1wb3J0IG1vZGVsIGZyb20gJy4uL21vZGVscy9sb2Fucyc7XG5pbXBvcnQgbW9kZWwxIGZyb20gJy4uL21vZGVscy9yZXBheW1lbnRzJztcblxuY2xhc3MgcG9zdHNDb250cm9sbGVyIHtcbi8vIGdldCBmdW5jdGlvblxuICBzdGF0aWMgZ2V0bG9hbnMocmVxLCByZXMpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICBtZXNzYWdlOiAnTGlzdCBvZiBhbGwgbG9hbnMnLFxuICAgICAgbG9hbjogbG9hbnMsXG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgZ2V0bm90cmVwYWlkKHJlcSwgcmVzKSB7XG4gICAgY29uc3QgY3VycmVudHN0YXR1cyA9ICdhcHByb3ZlZCc7XG4gICAgY29uc3QgY3VycmVudHJlcGFpZCA9IGZhbHNlO1xuICAgIGNvbnN0IGNoZWNrbm90cmVwYWlkID0gbG9hbnMuZmluZChvbmVsb2FucyA9PiBvbmVsb2Fucy5zdGF0dXMgPT0gY3VycmVudHN0YXR1cyAmJiBvbmVsb2Fucy5yZXBhaWQgPT0gY3VycmVudHJlcGFpZCk7XG4gICAgaWYgKGNoZWNrbm90cmVwYWlkKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgbWVzc2FnZTogJ0xpc3Qgb2YgYWxsIGxvYW5zIHRoYXQgYXJlIG5vdCBmdWxseSByZXBhaWQnLFxuICAgICAgICBsb2FuOiBjaGVja25vdHJlcGFpZCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICBzdGF0dXM6IDQwNCxcbiAgICAgIG1lc3NhZ2U6IFwiIGNhbid0IGZpbmQgYW55IGxvYW4gdGhhdCBpcyBub3QgZnVsbHkgcmVwYWlkXCIsXG5cbiAgICB9KTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRyZXBhaWQocmVxLCByZXMpIHtcbiAgICBjb25zdCBjdXJyZW50c3RhdHVzID0gJ2FwcHJvdmVkJztcbiAgICBjb25zdCBjdXJyZW50cmVwYWlkID0gdHJ1ZTtcbiAgICBjb25zdCBjaGVja3JlcGFpZCA9IGxvYW5zLmZpbmQob25lbG9hbnMgPT4gb25lbG9hbnMuc3RhdHVzID09IGN1cnJlbnRzdGF0dXMgJiYgb25lbG9hbnMucmVwYWlkID09IGN1cnJlbnRyZXBhaWQpO1xuICAgIGlmIChjaGVja3JlcGFpZCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIG1lc3NhZ2U6ICdMaXN0IG9mIGFsbCBsb2FucyB0aGF0IGFyZSAgZnVsbHkgcmVwYWlkJyxcbiAgICAgICAgbG9hbjogY2hlY2tyZXBhaWQsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgICAgc3RhdHVzOiA0MDQsXG4gICAgICBtZXNzYWdlOiBcIiBjYW4ndCBmaW5kIGFueSBsb2FuIHRoYXQgaXMgIGZ1bGx5IHJlcGFpZFwiLFxuXG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgZ2V0cmVwYXltZW50cyhyZXEsIHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdGF0dXM6IDIwMCxcbiAgICAgIG1lc3NhZ2U6ICdMaXN0IG9mIGFsbCByZXBheW1lbnRzJyxcbiAgICAgIHJlcGF5bWVudDogcmVwYXltZW50cyxcbiAgICB9KTtcbiAgfVxuXG5cbiAgLy8gY3JlYXRlIGZ1bmN0aW9uXG4gIHN0YXRpYyBjcmVhdGVsb2FucyhyZXEsIHJlcykge1xuICAgIGNvbnN0IGlkID0gcGFyc2VJbnQobG9hbnMubGVuZ3RoKSArIDE7XG4gICAgY29uc3Qge1xuICAgICAgZmlyc3RuYW1lLCBsYXN0bmFtZSwgZW1haWwsIHRlbm9yLCBhbW91bnQsXG4gICAgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnN0IHsgZXJyb3IsIHZhbHVlIH0gPSBqb2kudmFsaWRhdGUoXG4gICAgICB7XG4gICAgICAgIGZpcnN0bmFtZSxcbiAgICAgICAgbGFzdG5hbWUsXG4gICAgICAgIGVtYWlsLFxuICAgICAgICB0ZW5vcixcbiAgICAgICAgYW1vdW50LFxuICAgICAgfSxcbiAgICAgIFNjaGVtYS5sb2FuU2NoZW1hLFxuICAgICk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IGVycm9yOiBlcnJvci5kZXRhaWxzWzBdLm1lc3NhZ2UgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNoZWNrbG9hbiA9IG1vZGVsLmZpbmRFbWFpbChlbWFpbCk7XG4gICAgICAvLyBjb25zdCBjaGVja2xvYW4gPSBsb2Fucy5maW5kKG9uZWxvYW5zID0+IG9uZWxvYW5zLmVtYWlsID09IHJlcS5ib2R5LmVtYWlsKTtcbiAgICAgIGlmIChjaGVja2xvYW4pIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgICBtZXNzYWdlOiAnbG9hbiBhbHJlYWR5IGV4aXN0JyxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGxvYW5JbmZvID0gbW9kZWwuY3JlYXRlTG9hbihyZXEuYm9keSk7XG4gICAgICAvKlxuICAgIGNvbnN0IGluc2VydGxvYW4gPSB7XG4gICAgICBpZCxcbiAgICAgIGNyZWF0ZWRPbjptb21lbnQudXRjKCkuZm9ybWF0KCdERC1NTS1ZWVlZIEhIOk1NOlNTJyksXG4gICAgICBmaXJzdG5hbWUsXG4gICAgICBsYXN0bmFtZSxcbiAgICAgIGVtYWlsLFxuICAgICAgc3RhdHVzOlwicGVuZGluZ1wiLFxuICAgICAgcmVwYWlkOmZhbHNlLFxuICAgICAgdGVub3IsXG4gICAgICBhbW91bnQsXG4gICAgICBwYXltZW50SW5zdGFsbG1lbnQ6KHBhcnNlRmxvYXQocmVxLmJvZHkuYW1vdW50KStwYXJzZUZsb2F0KHJlcS5ib2R5LmFtb3VudCo1LzEwMCkpL3BhcnNlRmxvYXQocmVxLmJvZHkudGVub3IpLFxuICAgICAgYmFsYW5jZTpwYXJzZUZsb2F0KChwYXJzZUZsb2F0KHJlcS5ib2R5LmFtb3VudCkrcGFyc2VGbG9hdChyZXEuYm9keS5hbW91bnQqNS8xMDApKS9wYXJzZUZsb2F0KHJlcS5ib2R5LnRlbm9yKSp0ZW5vciksXG4gICAgICBpbnRlcmVzdDpyZXEuYm9keS5hbW91bnQqNS8xMDAsXG5cbiAgICB9O1xuICAgIGxvYW5zLnB1c2goaW5zZXJ0bG9hbik7XG4gICAgKi9cbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBtZXNzYWdlOiAnbG9hbiBjcmVhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgIGxvYW46IGxvYW5JbmZvLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIC8vIGNyZWF0ZSByZXBheW1lbnRzIGZ1bmN0aW9uXG5cbiAgc3RhdGljIGNyZWF0ZXJlcGF5bWVudHMocmVxLCByZXMpIHtcbiAgICBjb25zdCBpZCA9IHBhcnNlSW50KHJlcGF5bWVudHMubGVuZ3RoKSArIDE7XG4gICAgY29uc3QgeyBsb2FuaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgeyBwYWlkYW1vdW50IH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB7IGVycm9yLCB2YWx1ZSB9ID0gam9pLnZhbGlkYXRlKFxuICAgICAge1xuICAgICAgICBwYWlkYW1vdW50LFxuICAgICAgfSxcbiAgICAgIFNjaGVtYS5wYWlkYW1vdW50U2NoZW1hLFxuICAgICk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IGVycm9yOiBlcnJvci5kZXRhaWxzWzBdLm1lc3NhZ2UgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAvLyBjb25zdCBnZXRyZXBheW1lbnRzPW1vZGVsMS5maW5kcGF5bWVudGxvYW5pZChsb2FuaWQpO1xuICAgIC8vIGNvbnN0IGdldGxvYW4gPSBtb2RlbC5maW5kT25lKGxvYW5pZClcbiAgICAvLyBjb25zdCBnZXRyZXBheW1lbnRzPXJlcGF5bWVudHMuZmluZChnZXRsb2FucGF5bWVudHM9PmdldGxvYW5wYXltZW50cy5sb2FuSWQ9PSBwYXJzZUludChsb2FuaWQpKTtcbiAgICAgIGNvbnN0IGdldGxvYW4gPSBtb2RlbC5maW5kT25lKGxvYW5pZCk7XG4gICAgICBpZiAoZ2V0bG9hbikge1xuICAgICAgICBpZiAocGFyc2VGbG9hdChnZXRsb2FuLmJhbGFuY2UpIDwgcGFpZGFtb3VudCkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICd5b3UgcGF5ZWQgbXVjaCBtb25leSB0aGFuIHRoYXQgeW91IG11c3QgcGF5IG9uIHRoZSBiYWxhbmNlICEnLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnZXRsb2FuLnN0YXR1cyAhPSAnYXBwcm92ZWQnKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICAgICAgbWVzc2FnZTogJ3RoaXMgaXMgbm90IGFwcHJvdmVkICEnLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgUmVwYXltZW50ID0gbW9kZWwxLmNyZWF0ZVJlcGF5bWVudHMocmVxLmJvZHksIGxvYW5pZCk7XG5cbiAgICAgICAgLyogY29uc3QgaW5zZXJ0cmVwYXltZW50ID0ge1xuICAgICAgICAgaWQsXG4gICAgICAgICBjcmVhdGVkT246bW9tZW50LnV0YygpLmZvcm1hdCgnREQtTU0tWVlZWSBISDpNTTpTUycpLFxuICAgICAgICAgbG9hbklkOmdldGxvYW4uaWQsXG4gICAgICAgICBhbW91bnQ6Z2V0bG9hbi5hbW91bnQsXG4gICAgICAgICBtb250aGx5SW5zdGFsbG1lbnQ6Z2V0bG9hbi5wYXltZW50SW5zdGFsbG1lbnQsXG4gICAgICAgICBwYWlkYW1vdW50LFxuICAgICAgICAgYmFsYW5jZTpwYXJzZUZsb2F0KGdldHJlcGF5bWVudHMuYmFsYW5jZSktcGFyc2VGbG9hdChyZXEuYm9keS5wYWlkYW1vdW50KSxcblxuICAgICAgIH07XG4gICAgICAgcmVwYXltZW50cy5wdXNoKGluc2VydHJlcGF5bWVudCk7XG4gICAgICAgKi9cbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICBtZXNzYWdlOiAncGF5bWVudCBkb25lIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgICAgbG9hbjogUmVwYXltZW50LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBtZXNzYWdlOiBcInRoYXQgbG9hbiBkb2Vzbid0IGV4aXN0XCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyB1cGRhdGUgZnVuY3Rpb24gKHBhdGNoKVxuICBzdGF0aWMgdmVyaWZ5bG9hbihyZXEsIHJlcykge1xuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgeyBzdGF0dXMgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnN0IHsgZXJyb3IsIHZhbHVlIH0gPSBqb2kudmFsaWRhdGUoXG4gICAgICB7XG4gICAgICAgIHN0YXR1cyxcbiAgICAgIH0sXG4gICAgICBTY2hlbWEuYXBwcm92ZVNjaGVtYSxcbiAgICApO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBlcnJvcjogZXJyb3IuZGV0YWlsc1swXS5tZXNzYWdlIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBnZXRsb2FuID0gbW9kZWwuZmluZE9uZShpZCk7XG4gICAgICBpZiAoZ2V0bG9hbikge1xuICAgICAgICAoZ2V0bG9hbi5zdGF0dXMgPSBzdGF0dXMpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oe1xuICAgICAgICAgIHN0YXR1czogMjAxLFxuICAgICAgICAgIG1lc3NhZ2U6ICdsb2FuIGlzIGFwcHJvdmVkIHN1Y2Nlc2Z1bGx5JyxcbiAgICAgICAgICB1cGRhdGVQb3N0OiBnZXRsb2FuLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIGVycm9yOiBcImNhbid0IGZpbmQgdGhhdCBsb2FuIHdpdGggdGhhdCBpZFwiLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cblxuICAvLyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvLyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAvLyBnZXQgbG9hbiBieSBpZFxuICBzdGF0aWMgZ2V0T25lbG9hbihyZXEsIHJlcykge1xuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgZmluZGxvYW4gPSBtb2RlbC5maW5kT25lKGlkKTtcbiAgICAvKlxuICBjb25zdCBmaW5kbG9hbiA9IGxvYW5zLmZpbmQob25lbG9hbnMgPT4gb25lbG9hbnMuaWQgPT0gaWQpO1xuICAqL1xuICAgIGlmIChmaW5kbG9hbikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgIG1lc3NhZ2U6ICdvbmUgbG9hbiBmb3VuZCcsXG4gICAgICAgIGxvYW46IGZpbmRsb2FuLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgIHN0YXR1czogNDAwLFxuICAgICAgZXJyb3I6ICdubyBsb2FuIGZvdW5kIHdpdGggdGhhdCBpZCcsXG4gICAgfSk7XG4gIH1cblxuICAvLyBnZXQgcGF5bWVudCBieSBpZFxuICBzdGF0aWMgZ2V0T25lcGF5bWVudChyZXEsIHJlcykge1xuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgZ2V0cGF5bWVudCA9IG1vZGVsMS5maW5kT25lcGF5bWVudHMoaWQpO1xuICAgIC8vIGNvbnN0IGdldHBheW1lbnQgPSByZXBheW1lbnRzLmZpbmQob25lcGF5bWVudCA9PiBvbmVwYXltZW50LmlkID09IGlkKTtcbiAgICBpZiAoZ2V0cGF5bWVudCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogJ3BheW1lbnQgZm91bmQnLFxuICAgICAgICBwYXltZW50OiBnZXRwYXltZW50LFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgIHN0YXR1czogNDAwLFxuICAgICAgZXJyb3I6ICdubyBwYXltZW50IGZvdW5kIHdpdGggdGhhdCBpZCcsXG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgZGVsZXRlbG9hbihyZXEsIHJlcykge1xuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgZmluZGxvYW4gPSBsb2Fucy5maW5kSW5kZXgobG9hbiA9PiBsb2FuLmlkID09IGlkKTtcbiAgICBpZiAoZmluZGxvYW4gPiAtMSkge1xuICAgICAgbG9hbnMuc3BsaWNlKGZpbmRsb2FuLCAxKTtcbiAgICAgIGNvbnN0IG5ld2xvYW4gPSBsb2Fucy5maWx0ZXIobG9hbiA9PiBsb2FuICE9PSBmaW5kbG9hbik7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBtZXNzYWdlOiAnbG9hbiBzdWNjZXNzZnVsbHkgZGVsZXRlZCcsXG4gICAgICAgIGxvYW46IG5ld2xvYW4sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgZXJyb3I6ICdjb3VsZCBub3QgZmluZCB0aGF0IGxvYW4nLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgcG9zdHNDb250cm9sbGVyO1xuIl19